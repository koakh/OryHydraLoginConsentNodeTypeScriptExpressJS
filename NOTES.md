# NOTES

```shell
$ cd /mnt/storage/Development/@OAuth2/Ory/Hydra/OryHydraIntegratingOAuth20WithARustWebService/hydra-auth-example-rs
$ docker-compose up -d
$ curl -X POST \
  http://localhost:4445/clients \
  -H 'Content-Type: application/json' \
  -d '{
	"client_id": "my-implicit-client",
	"grant_types": ["implicit"],
	"response_types": ["token"],
	"redirect_uris": ["http://localhost:3000/"],
	"token_endpoint_auth_method": "client_secret_post"
}'

# $ curl -X POST \
#   http://localhost:4445/clients \
#   -H 'Content-Type: application/json' \
#   -d '{
# 	"client_id": "my-client-credentials-client",
# 	"grant_types": ["client_credentials"],
# 	"response_types": ["token"],
# 	"scope": "offline openid offline_access email phone profile address",
# 	"redirect_uris": ["http://localhost:3000/"],
# 	"token_endpoint_auth_method": "client_secret_post"
# }'

$ curl -s -X GET http://localhost:4445/clients/my-implicit-client | jq
# $ curl -s -X GET http://localhost:4445/clients/my-client-credentials-client | jq
```

To start the flow, navigate to [Authorization Initialization link](localhost:4444/oauth2/auth?client_id=my-implicit-client&response_type=token&scope=offline&state=blahblahblah) which is usually generated by an OAuth2 client or library.

To start the flow, navigate to [Authorization Initialization link](localhost:4444/oauth2/auth?client_id=my-client-credentials-client&response_type=token&scope=offline&state=blahblahblah) which is usually generated by an OAuth2 client or library.

## Add Permissions and Roles to JWT

add to `src/routes/consent.ts`

```typescript
// The session allows us to set session data for id and access tokens
let session: ConsentRequestSession = {
	// This data will be available when introspecting the token. Try to avoid sensitive information here,
	// unless you limit who can introspect tokens.
	access_token: {
		// foo: 'bar'
	},

	// This data will be available in the ID token.
	id_token: {
		// baz: 'bar'
		permissions: ['create:items', 'update:items', 'delete:items'],
		roles: ['ROLE_USER', 'ROLE_ADMIN']
	}
}
```

now logout and login and inspect jwt

```json
"permissions": [
	"create:items",
	"update:items",
	"delete:items"
],
"roles": [
	"ROLE_USER",
	"ROLE_ADMIN"
]
```
